from aiohttp import web
from handlers.default import handle
from handlers.upload import upload_file


if __name__ == '__main__':
    app = web.Application()
    routes = [
        web.static("/static", "static/", follow_symlinks=True),  # This line introduces the vulnerability. Remove follow_symlinks to avoid it.
        web.get('/', handle),
        web.get('/{name}', handle),
        web.post('/upload', upload_file),
    ]
    app.add_routes(routes)
    web.run_app(app)